# Elubrazione's QMusic
* 一个简化版QQ音乐新碟 `HTML` 页面


### 要求清单
- *~~这个git仓库上markdown的打勾样式怎么显示不出来~~*
- 使用动态创建DOM方式实现页面
- 默认展示第一个列表，点击标签项动态切换下方列表内容
- 鼠标悬停列表项会出现删除按钮，点击删除按钮可以将该条目删除
- 记录作业完成的思路和遇到的问题
- 列表项的列数从1到5逐级过渡，内容部分宽度最大不超过 1200px.
- 页面支持响应式（应该）
- 遵循standard.js代码风格（改了很多，可能还有一些没发现的地方）


### 完成思路
1. 静态节点和动态节点的划分。
2. 按header、tab、albums三部分顺序完成：header直接静态生成，写在html文件里；tab和albums都用 `document.createElement()` 动态生成。
3. 加载 `./data` 目录下的 `albums.json` 和 `areas.json` 数据，保存在对应的数组里。
4. 在 `./scripts/index.js` 中编写动态生成节点的代码。
5. 从Chrome DevTools中复制对应的css样式到 `./styles/style.css` 文件中。
6. 为tab和albums绑定各自的事件(addEventListener)，分别是点击切换列表并重新生成节点和删除专辑。
7. 解决列表项从1-5逐级过渡等各种样式问题。

### 问题及解决方式
**1. 不知道要怎么导入json的数据，试了几个方法（比如import）在浏览器上会报错**
* 尝试和搜索方法的过程中发现可以使用XMLHttpRequest发送Ajax请求来获得数据。

**2. 不知道要怎么切换tab效果，以及怎么不适用额外的开销默认展示第一个列表**
* 其实不太知道比较好的做法是什么，前者（切换tab效果）最后选择的做法是在js代码里直接修改点击元素的ClassName属性；后者是在读入area.json的数据时，在第一重循环（也就是读入第一个地区）时就生成符合条件的albums节点。为了方便我把导航栏绑定的点击事件拆成了三级函数，依次调用下一级：

    * `tabClick(e)` 修改导航栏对应的CSS属性，获取新的地区名；
    * `selectAlbums(e)` 根据地域名，从存有专辑信息的数组里筛选出待生成的专辑；
    * `createAlbumsDom(e)` 生成完整Albums节点，包含专辑封面、名称、歌手、时间、删除按钮等；

    在上面说的第一重循环里直接跳过 `tabClick(e)`，传递第一个地区名给 `selectAlbums(e)` 生成第一个列表的专辑。

**3. 点击删除按钮删除节点，重新加载后发现结点并没有被删除**
* 根据要删除专辑的名字用 `Array.find()` 获取其在数组中完整的键值对信息，再用 `Array.indexOf()` 获得其索引，最后用 `Array.splice()` 在数组中彻底删除。
* 但是我发现即使这样，重新加载后还是没有删除，经过debug后发现是我每次调用函数生成专辑的时候又重新读了一次json（因为我一开始把读albums数据和筛albums这两个功能写在了一起），所以后来独立出来了一个 `LoadAlbumData()` 函数。

**4. 一些小问题如：点击每个tab中间的部分会把整个导航栏变绿、点击当前所在的专辑列表也会重新生成专辑、列表项的列数大于5等**
* 把监听事件绑定在动态生成的 `li` 标签上，可以生成之后立刻就绑定；删除专辑同理；
* 修改CSS属性时判断一下是不是已经是tab_active属性；
* 看了老师写的demo代码，学会了使用 `@media screen and (min-width: 1280px)` 的方法。